# 可以更新功能

- ~~更多驱动~~
  - ~~以前购买过的屏幕~~
  - ~~7789	240 * 320	240 * 280	240 * 240	135 * 240	170 * 320~~
  - ~~GC9A01	240  * 240~~
  - ~~7735	 80  * 160	128  * 160	128 * 128~~
  - ~~GC9107	128 * 128~~
  - ~~ili9488    320*240~~
  - ~~st7796    320* 240~~
- 有一个硬件波形，试试看
- 使用示例



- 快速一次性加载所有字体的函数，很早就被误删了，需要重新实现，不过先得重新查看一下自制bmf的格式
- 3线spi，还可以省略 DC 引脚



- ~~TE引脚播放视频测试~~

- ~~用杜邦线连接，cs使能时，dc切换时，需要加点延迟~~
- ~~减少颜色~~
- ~~预设色彩为类属性，多屏幕使用不同bit会冲突~~
- ~~某些数据，会占用大量内存，多个实例总体维护一份即可~~
- ~~单个字符缓存大小，由加载字符时最大尺寸字符决定，算了有时也会手动添加几个~~
- ~~已经是列刷新了，字符显示可以加快，不使用多次 _set_window~~
- ~~波形更新，添加min数据、多波形单独像素 和 自适应模式，没有管自适应，每次变化都要生成1帧数据应该快不了~~
- ~~4线SPI下，理论上非常简单就可以节省引脚，测试无误后支持它~~
  - ~~1个SPI设备，3个引脚，SCL,SDA,DC~~
  - ~~2个SPI设备，4个引脚，SCL,SDA,DC,CS，CS反向~~
  - 3个及以上SPI设备
    - 似乎在很多地方，听说一种二进制 转  数据位的芯片，2CS挂4个设备，3个CS挂8个设备
    - 上面方法还是需要大于一个引脚，猜测应该有1扩N的数字芯片，就是不知道是否可以白嫖

- ~~更多驱动~~

  - ~~以前购买过的屏幕~~

  - ~~7789	240 * 320	240 * 280	240 * 240	135 * 240	170 * 320~~

  - ~~GC9A01	240  * 240~~

  - ~~7735	 80  * 160	128  * 160	128 * 128~~

  - ~~GC9107	128 * 128~~

  - ~~ili9488    320*240~~

  - ~~st7796    320* 240~~



# 速度问题记录 (测试ESP32-S3,SPI=80M)

~~~python
# 刷新大量数据时 （ESP32S3）
	# 推算实际为	30MHZ
    # 示波器查看 40MHZ
    # 网上搜索	 80MHZ
	# 官网某个文档看到，默认引脚80MHZ，非默认引脚40MHZ，未验证
    
# 问题1：少10Mhz问题，单独记录每一次刷新屏幕耗时，刷新460800字节，出现了2种数据	(已解决)
    # 1、速度 95 ~ 105ms, 基本稳定在100已内，推算SPI为40MHZ完全符合
    # 2、速度 160 ~ 180ms
        # 我在开发时，使用的是网络更新，有一个单独的线程频繁发送网络请求，也许是网络线程打断了
        # 由于SPI.write(),传入的是memoryview，所以忘记查看是否会是GC导致了
        
# 问题2：少40Mhz问题(已解决)
	# 问题也许来自分频(?)，不过我不知道那是什么东西，不过我大约听说过SPI频率和时钟树(?)有关
    # 基于问题，推测SPI无法设置指定频率，只能选择几个固定频率，所以指定的频率未曾生效
    	# 解决，给一个 >= 最高频率的频率
        # 10MHZ、20MHZ、26.66MHZ、40MHZ、80MHZ,随便指定了几个频率返回的频率，示波器只验证了80MHZ
        # 似乎没规律，有兴趣在搜一下看看，实际原因
    # 80MHZ写入上面同样的数据返回时间，推算SPI为80MHZ完全符合
    	# 1、速度 49ms最多，50ms次之
        # 2、速度 119 ~ 121ms


# 使用问题已经完全解决，剩下两个小问题
	# 1、SPI写入时，偶尔耗时会变多60~70MS
    	# 判断网络线程工作的原因
        # 因为无论频率如何，平均时间总是多了20MS左右。
        # 如果是GC数据量都翻倍了。
    # 2、SPI频率只能使用一些固定值，是因为什么
~~~



# ESP32S3 N16R8模组 硬盘和网络访问速度

~~~python
# 官方模组硬盘访问速度
0.8MiB~1MiB

# 非官方模组硬盘访问速度
1.1MiB~1.3MiB

# 在github上看到过，有人通过修改固件硬盘读取速度达到了6M还是8M去了，修改前速度和我基本一致


# WIFI速度 N年前拉宽带自带的，距离几十里面

# Wi-Fi 已连接: 192.168.1.11
# TCP 已连接
1.6155909MiB/s 


# Wi-Fi已连接: 192.168.1.2
# UDP监听中...
2.8595062MiB/s 


# 1472，UDP单包计时 最快325us 
>>> 1_000_000 / 325 * 1472 / 1024 / 1024
4.319411057692308

>>> 1_000_000 / 325 * 1500 / 1024 / 1024
4.401573768028847

>>> 1_000_000 / 300 * 1500 / 1024 / 1024
4.76837158203125

>>> 1_000_000 / 300 * 1500 / 1024 / 1024 * 8
38.14697265625
~~~







# 几个速度记录

~~~shell
MPY: soft reboot
空循环1W次耗时: 24773
空循环2W次耗时: 49393
空循环4W次耗时: 99071
循环1W次空函数耗时: 88534
循环2W次空函数耗时: 177037
循环4W次空函数耗时: 353925
循环1W次复杂类空成员函数数耗时: 110882
循环2W次复杂类空成员函数数耗时: 222157
循环4W次复杂类空成员函数数耗时: 444956
循环1W次简单类空成员函数耗时: 108202
循环2W次简单类空成员函数耗时: 216783
循环4W次简单类空成员函数耗时: 433752
循环1W次全局变量耗时: 37346
循环2W次全局变量耗时: 74733
循环4W次全局变量耗时: 149199
循环1W次简单类空成员变量耗时: 40254
循环2W次简单类空成员变量耗时: 80546
循环4W次简单类空成员变量耗时: 161271
循环1W次复杂类空成员变量耗时: 40491
循环2W次复杂类空成员变量耗时: 80717
循环4W次复杂类空成员变量耗时: 161248
循环1W次if耗时: 47888
循环2W次if耗时: 96006
循环4W次if耗时: 240192
~~~

